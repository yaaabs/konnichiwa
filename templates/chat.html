<!DOCTYPE html>
<html>
<head>
  <title>Konnichiyabs Chat</title>
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <script>
    const socket = io();
    window.onload = () => {
      const username = "{{ username }}";
      socket.emit("join", { username });

      const form = document.getElementById("chat-form");
      form.addEventListener("submit", e => {
        e.preventDefault();
        const input = document.getElementById("message-input");
        socket.emit("message", input.value);
        input.value = "";
      });

      socket.on("message", data => {
        const box = document.getElementById("chat-box");
        const div = document.createElement("div");
        div.textContent = `${data.username}: ${data.msg}`;
        box.appendChild(div);
      });

      socket.on("user_joined", data => {
        const box = document.getElementById("chat-box");
        const div = document.createElement("div");
        div.textContent = `üëã ${data.username} joined`;
        box.appendChild(div);
      });

      socket.on("user_left", data => {
        const box = document.getElementById("chat-box");
        const div = document.createElement("div");
        div.textContent = `‚ùå ${data.username} left`;
        box.appendChild(div);
      });
    };
  </script>
</head>
<body>
  <h2>Welcome to Konnichiyabs, {{ username }}!</h2>
  <div id="chat-box" style="border: 1px solid #ccc; height: 300px; overflow-y: scroll;"></div>
  <form id="chat-form">
    <input id="message-input" placeholder="Type message..." required>
    <button type="submit">Send</button>
  </form>
</body>
</html>
